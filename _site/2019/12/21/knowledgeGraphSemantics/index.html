<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Spark for Big Data Analytics.">

    <title>Knowledge Graph for Semantic Data Mining - Sparkling Data Ocean</title>

    <link rel="canonical" href="http://localhost:4000/2019/12/21/knowledgeGraphSemantics/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/clean-blog.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Sparkling Data Ocean" />
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-114694347-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-114694347-1');
    </script>

</head>


<body>

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Sparkling Data Ocean</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <li>
                    <a href="/">Home</a>
                </li>
                
				
                <li>
                    <a href="/about/">About</a>
                </li>
				
                
            </ul>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>


    <!-- Post Header -->
<header class="intro-header" style="background-image: url('/img/modern119j.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <h1>Knowledge Graph for Semantic Data Mining</h1>
                    
                    <h2 class="subheading">Spark Knowledge Graph to find new connections</h2>
                    
                    <span class="meta">Posted by Melenar on December 21, 2019</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">

				<p><h3>Semantic Knowledge Graphs</h3>

<p>
In this post we will show some specific examples of using knowledge graph for data mining.

Using the same Kaggle dataset as in previous post
 <i><a href="https://www.kaggle.com/momanyc/museum-collection">
 'Museum of Modern Art Collection'</a></i> from MoMA collection we will deeper explore titles of paintings and time when paintings were created. Analyzing title semantics we will show connections between artists and titles as well as differences in modern art styles in different time periods.
</p>

<h3>Read and Clean the Data</h3>
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">import</span> <span class="nn">org.apache.spark.ml._</span>
<span class="k">import</span> <span class="nn">org.apache.spark.ml.feature._</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.DataFrame</span>
<span class="k">import</span> <span class="nn">org.graphframes.GraphFrame</span>
<span class="k">import</span> <span class="nn">org.apache.spark.sql.functions._</span>

<span class="k">val</span> <span class="n">data</span><span class="k">=</span><span class="n">sqlContext</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">format</span><span class="o">(</span><span class="s">"csv"</span><span class="o">).</span>
  <span class="n">option</span><span class="o">(</span><span class="s">"header"</span><span class="o">,</span><span class="s">"true"</span><span class="o">).</span><span class="n">load</span><span class="o">(</span><span class="s">"/FileStore/tables/daYes2.txt"</span><span class="o">)</span></code></pre></figure>


<p>Get artist names, painting titles and dates when paintings were created:</p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">titleData</span><span class="k">=</span><span class="n">data</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">,</span><span class="s">"Date"</span><span class="o">).</span><span class="n">distinct</span>

<span class="n">display</span><span class="o">(</span><span class="n">titleData</span><span class="o">)</span>
<span class="nc">Artist</span><span class="o">,</span><span class="nc">Title</span><span class="o">,</span><span class="nc">Date</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="s">"Rope and People, I"</span><span class="o">,</span><span class="s">"Barcelona, March 27, 1935"</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="nc">Fire</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Evening</span><span class="o">,</span><span class="mi">1929</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="nc">Portrait</span> <span class="n">of</span> <span class="n">an</span> <span class="nc">Equilibrist</span><span class="o">,</span><span class="mi">1927</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Guitar</span><span class="o">,</span><span class="s">"Paris, early 1919"</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="nc">The</span> <span class="nc">Bather</span><span class="o">,</span><span class="n">c</span><span class="o">.</span> <span class="mi">1885</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="s">"Composition in White, Black, and Red"</span><span class="o">,</span><span class="nc">Paris</span> <span class="mi">1936</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Girl</span> <span class="n">before</span> <span class="n">a</span> <span class="nc">Mirror</span><span class="o">,</span><span class="s">"Paris, March 14, 1932"</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Mandolin</span><span class="o">,</span><span class="mi">1937</span>
<span class="nc">Vasily</span> <span class="nc">Kandinsky</span><span class="o">,</span><span class="nc">Panel</span> <span class="k">for</span> <span class="nc">Edwin</span> <span class="n">R</span><span class="o">.</span> <span class="nc">Campbell</span> <span class="nc">No</span><span class="o">.</span> <span class="mi">3</span><span class="o">,</span><span class="mi">1914</span>
<span class="nc">Paul</span> <span class="nc">Gauguin</span><span class="o">,</span><span class="nc">Portrait</span> <span class="n">of</span> <span class="nc">Jacob</span> <span class="nc">Meyer</span> <span class="n">de</span> <span class="nc">Haan</span><span class="o">,</span><span class="mi">1889</span>
<span class="nc">Vasily</span> <span class="nc">Kandinsky</span><span class="o">,</span><span class="nc">Panel</span> <span class="k">for</span> <span class="nc">Edwin</span> <span class="n">R</span><span class="o">.</span> <span class="nc">Campbell</span> <span class="nc">No</span><span class="o">.</span> <span class="mi">1</span><span class="o">,</span><span class="mi">1914</span>
<span class="nc">Max</span> <span class="nc">Beckmann</span><span class="o">,</span><span class="nc">Departure</span><span class="o">,</span><span class="s">"Frankfurt 1932, Berlin 1933-35"</span>
<span class="nc">Jackson</span> <span class="nc">Pollock</span><span class="o">,</span><span class="nc">Shimmering</span> <span class="nc">Substance</span><span class="o">,</span><span class="mi">1946</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span><span class="o">,</span><span class="s">"Paris, early 1899"</span>
<span class="nc">Jackson</span> <span class="nc">Pollock</span><span class="o">,</span><span class="s">"One: Number 31, 1950"</span><span class="o">,</span><span class="mi">1950</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Soda</span><span class="o">,</span><span class="s">"Paris, spring 1912"</span></code></pre></figure>



<p><h3>When Paintings Were Created?</h3>
<p>Looking at data examples we can see that "Date" column has a semi-structured data.
Some of these column values have just a year, some columns show time periods, some columns show specific months or days, and some columns show time and place where the painting was created.

</p><p>
'Date' column examples:
<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Paul Klee, Fire in the Evening, </font>
<font style="color:rgb(177, 77, 77);">1929</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Joan Miró, Rope and People, I,  </font>
<font style="color:rgb(177, 77, 77);">Barcelona, March 27, 1935</font>
</i></medium>
<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Pablo Picasso,  Guitar,  </font>
<font style="color:rgb(177, 77, 77);">Paris, early 1919</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Paul Cézanne,  Still Life with Apples,  </font>
<font style="color:rgb(177, 77, 77);">1895-98</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Max Beckmann,  Family Picture,  </font>
<font style="color:rgb(177, 77, 77);">Frankfurt 1920</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Joan Miró, The Hunter (Catalan Landscape),  </font>
<font style="color:rgb(177, 77, 77);">July 1923-winter 1924</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Henri Matisse,  Gourds,  </font>
<font style="color:rgb(177, 77, 77);">1915-16 (dated on painting 1916)</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Georges Braque,  Man with a Guitar,  </font>
<font style="color:rgb(177, 77, 77);">Céret, summer 1911-early 1912</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Kazimir Malevich,  Suprematist Painting,  </font>
<font style="color:rgb(177, 77, 77);">1916-17</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Natalia Goncharova, Rayonism, Blue-Green Forest,  </font>
<font style="color:rgb(177, 77, 77);">1913 (dated on reverse 1911)</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Max Beckmann, Departure,  </font>
<font style="color:rgb(177, 77, 77);">Frankfurt 1932, Berlin 1933-35</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Piet Mondrian, Truncated View of the Broekzijder Mill on the Gein, Wings Facing West,  </font>
<font style="color:rgb(177, 77, 77);">c. 1902-03 or earlier</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Henri Matisse, The Red Studio,  </font>
<font style="color:rgb(177, 77, 77);">Issy-les-Moulineaux, fall 1911</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Claude Monet, Water Lilies,  </font>
<font style="color:rgb(177, 77, 77);">1914-26</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Marc Chagall, Over Vitebsk,  </font>
<font style="color:rgb(177, 77, 77);">1915-20 (after a painting of 1914)</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Jackson Pollock, Circle,  </font>
<font style="color:rgb(177, 77, 77);">c. 1938-41</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Henri Matisse, The Red Studio,  </font>
<font style="color:rgb(177, 77, 77);">Issy-les-Moulineaux, fall 1911</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Henri Matisse, Goldfish and Palette,  </font>
<font style="color:rgb(177, 77, 77);">Paris, quai Saint-Michel, late November 1914-spring 1915</font>
</i></medium>

<medium><i>
<br />
<font style="color:rgb(128, 128, 128);">Joan Miró, Still Life with Old Shoe,  </font>
<font style="color:rgb(177, 77, 77);">Paris, January 24-May 29, 1937</font>
</i></medium>

<h4>Cleaning the data</h4>
<p></p>
To define the year when painting was created we will extract the latest year from 'Date' columns:


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">titleLastYear</span><span class="k">=</span><span class="n">titleData</span><span class="o">.</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"period"</span><span class="o">,</span><span class="n">regexp_extract</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"Date"</span><span class="o">),</span><span class="s">"\\d{4}-\\d{2}"</span><span class="o">,</span><span class="mi">0</span><span class="o">)).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"periodEnd"</span><span class="o">,</span><span class="n">concat</span><span class="o">(</span><span class="n">substring</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"period"</span><span class="o">),</span><span class="mi">1</span><span class="o">,</span><span class="mi">2</span><span class="o">),</span><span class="n">substring</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"period"</span><span class="o">),</span><span class="mi">6</span><span class="o">,</span><span class="mi">7</span><span class="o">))).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"year1"</span><span class="o">,</span><span class="n">regexp_extract</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"Date"</span><span class="o">),</span><span class="s">"\\d{4}"</span><span class="o">,</span><span class="mi">0</span><span class="o">)).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"date2"</span><span class="o">,</span><span class="n">regexp_replace</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"Date"</span><span class="o">),</span> <span class="n">col</span><span class="o">(</span><span class="s">"period"</span><span class="o">),</span> <span class="n">lit</span><span class="o">(</span><span class="s">""</span><span class="o">))).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"date3"</span><span class="o">,</span><span class="n">regexp_replace</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"date2"</span><span class="o">),</span> <span class="n">col</span><span class="o">(</span><span class="s">"year1"</span><span class="o">),</span> <span class="n">lit</span><span class="o">(</span><span class="s">""</span><span class="o">))).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"year2"</span><span class="o">,</span><span class="n">regexp_extract</span><span class="o">(</span><span class="n">col</span><span class="o">(</span><span class="s">"date3"</span><span class="o">),</span><span class="s">"\\d{4}"</span><span class="o">,</span><span class="mi">0</span><span class="o">)).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"year3"</span><span class="o">,</span><span class="n">greatest</span><span class="o">(</span><span class="s">"year1"</span><span class="o">,</span><span class="s">"periodEnd"</span><span class="o">)).</span>
<span class="n">withColumn</span><span class="o">(</span><span class="s">"lastYear"</span><span class="o">,</span><span class="n">greatest</span><span class="o">(</span><span class="s">"year2"</span><span class="o">,</span><span class="s">"year3"</span><span class="o">)).</span>
<span class="n">drop</span><span class="o">(</span><span class="s">"period"</span><span class="o">,</span><span class="s">"periodEnd"</span><span class="o">,</span><span class="s">"year1"</span><span class="o">,</span><span class="s">"date2"</span><span class="o">,</span><span class="s">"date3"</span><span class="o">,</span><span class="s">"year2"</span><span class="o">,</span><span class="s">"year3"</span><span class="o">)</span>

<span class="n">display</span><span class="o">(</span><span class="n">titleLastYear</span><span class="o">)</span>
<span class="nc">Artist</span><span class="o">,</span><span class="nc">Title</span><span class="o">,</span><span class="nc">Date</span><span class="o">,</span><span class="n">lastYear</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="s">"Rope and People, I"</span><span class="o">,</span><span class="s">"Barcelona, March 27, 1935"</span><span class="o">,</span><span class="mi">1935</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="nc">Fire</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Evening</span><span class="o">,</span><span class="mi">1929</span><span class="o">,</span><span class="mi">1929</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Girl</span> <span class="n">before</span> <span class="n">a</span> <span class="nc">Mirror</span><span class="o">,</span><span class="s">"Paris, March 14, 1932"</span><span class="o">,</span><span class="mi">1932</span>
<span class="nc">Max</span> <span class="nc">Beckmann</span><span class="o">,</span><span class="nc">Departure</span><span class="o">,</span><span class="s">"Frankfurt 1932, Berlin 1933-35"</span><span class="o">,</span><span class="mi">1935</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="n">I</span><span class="o">,</span><span class="nc">Montroig</span> <span class="n">and</span> <span class="nc">Paris</span> <span class="mi">1922</span><span class="o">-</span><span class="mi">23</span><span class="o">,</span><span class="mi">1923</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="s">"Still Life with Ginger Jar, Sugar Bowl, and Oranges"</span><span class="o">,</span><span class="mi">1902</span><span class="o">-</span><span class="mi">06</span><span class="o">,</span><span class="mi">1906</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Gourds</span><span class="o">,</span><span class="s">"Issy-les-Moulineaux, 1915-16 (dated on painting 1916)"</span><span class="o">,</span><span class="mi">1916</span>
<span class="nc">Vincent</span> <span class="n">van</span> <span class="nc">Gogh</span><span class="o">,</span><span class="nc">Portrait</span> <span class="n">of</span> <span class="nc">Joseph</span> <span class="nc">Roulin</span><span class="o">,</span><span class="s">"Arles, early 1889"</span><span class="o">,</span><span class="mi">1889</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="s">"Truncated View of the Broekzijder Mill on the Gein, Wings Facing West"</span><span class="o">,</span><span class="n">c</span><span class="o">.</span> <span class="mi">1902</span><span class="o">-</span><span class="mi">03</span> <span class="n">or</span> <span class="n">earlier</span><span class="o">,</span><span class="mi">1903</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Chasuble</span><span class="o">,</span><span class="mi">1950</span><span class="o">-</span><span class="mi">52</span> <span class="o">(</span><span class="n">manufactured</span> <span class="mi">1955</span><span class="o">),</span><span class="mi">1955</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Mural</span> <span class="nc">Painting</span><span class="o">,</span><span class="s">"Barcelona, October 18, 1950-January 26, 1951"</span><span class="o">,</span><span class="mi">1951</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="nc">Water</span> <span class="nc">Lilies</span><span class="o">,</span><span class="mi">1914</span><span class="o">-</span><span class="mi">26</span><span class="o">,</span><span class="mi">1926</span>
<span class="nc">Natalia</span> <span class="nc">Goncharova</span><span class="o">,</span><span class="s">"Rayonism, Blue-Green Forest"</span><span class="o">,</span><span class="mi">1913</span> <span class="o">(</span><span class="n">dated</span> <span class="n">on</span> <span class="n">reverse</span> <span class="mi">1911</span><span class="o">),</span><span class="mi">1913</span></code></pre></figure>

</p><p>
<p><h3>Transform Painting Titles to Words</h3>
<p></p>
To analyze 'Title' text column we will use the following data preparation process:
<ul>
<li>Read text column</li>
<li>Tokenize text column</li>
<li>Remove stop words</li>

</ul>
<p></p>
First, we'll see how many paintings we have for each artist. Of course, Picasso has the biggest number:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">titleLastYear</span><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">).</span><span class="n">count</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="ss">'count.</span><span class="n">desc</span><span class="o">))</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">55</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">34</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">19</span>
<span class="nc">Jackson</span> <span class="nc">Pollock</span><span class="o">,</span><span class="mi">18</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="mi">16</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="mi">14</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">10</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="mi">9</span>
<span class="nc">Vasily</span> <span class="nc">Kandinsky</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="mi">5</span>
<span class="nc">Oskar</span> <span class="nc">Kokoschka</span><span class="o">,</span><span class="mi">4</span>
<span class="nc">Max</span> <span class="nc">Beckmann</span><span class="o">,</span><span class="mi">4</span>
<span class="nc">Marc</span> <span class="nc">Chagall</span><span class="o">,</span><span class="mi">4</span>
<span class="nc">Vincent</span> <span class="n">van</span> <span class="nc">Gogh</span><span class="o">,</span><span class="mi">3</span>
<span class="nc">Paul</span> <span class="nc">Gauguin</span><span class="o">,</span><span class="mi">3</span>
<span class="nc">Natalia</span> <span class="nc">Goncharova</span><span class="o">,</span><span class="mi">2</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="mi">2</span>
<span class="nc">Egon</span> <span class="nc">Schiele</span><span class="o">,</span><span class="mi">1</span>
<span class="nc">Franz</span> <span class="nc">Marc</span><span class="o">,</span><span class="mi">1</span></code></pre></figure>


<p></p>
Tokenize 'Title' column:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">tokenizer</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">RegexTokenizer</span><span class="o">().</span>
   <span class="n">setInputCol</span><span class="o">(</span><span class="s">"Title"</span><span class="o">).</span>
   <span class="n">setOutputCol</span><span class="o">(</span><span class="s">"value"</span><span class="o">).</span>
   <span class="n">setPattern</span><span class="o">(</span><span class="s">"[^a-z]+"</span><span class="o">).</span>
   <span class="n">setMinTokenLength</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span>
   <span class="n">setGaps</span><span class="o">(</span><span class="kc">true</span><span class="o">)</span>
<span class="k">val</span> <span class="n">tokenizedTitle</span> <span class="k">=</span> <span class="n">tokenizer</span><span class="o">.</span>
   <span class="n">transform</span><span class="o">(</span><span class="n">titleLastYear</span><span class="o">)</span>

<span class="n">display</span><span class="o">(</span><span class="n">tokenizedTitle</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">,</span><span class="s">"value"</span><span class="o">))</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="s">"Rope and People, I"</span><span class="o">,</span><span class="s">"[""rope"",""and"",""people""]"</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="nc">Fire</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Evening</span><span class="o">,</span><span class="s">"[""fire"",""the"",""evening""]"</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Guitar</span><span class="o">,</span><span class="s">"[""guitar""]"</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="nc">The</span> <span class="nc">Bather</span><span class="o">,</span><span class="s">"[""the"",""bather""]"</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Mandolin</span><span class="o">,</span><span class="s">"[""woman"",""with"",""mandolin""]"</span></code></pre></figure>


<p></p>
Remove stop words:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala">   
<span class="k">val</span> <span class="n">remover</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">StopWordsRemover</span><span class="o">().</span>
   <span class="n">setInputCol</span><span class="o">(</span><span class="s">"value"</span><span class="o">).</span>
   <span class="n">setOutputCol</span><span class="o">(</span><span class="s">"stopWordFree"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">removedStopWordsTittle</span> <span class="k">=</span> <span class="n">remover</span><span class="o">.</span>
   <span class="n">setStopWords</span><span class="o">(</span><span class="nc">Array</span><span class="o">(</span><span class="s">"none"</span><span class="o">,</span><span class="s">"also"</span><span class="o">,</span><span class="s">"nope"</span><span class="o">,</span><span class="s">"null"</span><span class="o">)++</span>
   <span class="n">remover</span><span class="o">.</span><span class="n">getStopWords</span><span class="o">).</span>
   <span class="n">transform</span><span class="o">(</span><span class="n">tokenizedTittle</span><span class="o">)</span>

<span class="n">display</span><span class="o">(</span><span class="n">removedStopWordsTitle</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">,</span><span class="s">"value"</span><span class="o">,</span><span class="s">"stopWordFree"</span><span class="o">))</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="s">"Rope and People, I"</span><span class="o">,</span><span class="s">"[""rope"",""and"",""people""]"</span><span class="o">,</span><span class="s">"[""rope"",""people""]"</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="nc">Fire</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Evening</span><span class="o">,</span><span class="s">"[""fire"",""the"",""evening""]"</span><span class="o">,</span><span class="s">"[""fire"",""evening""]"</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Guitar</span><span class="o">,</span><span class="s">"[""guitar""]"</span><span class="o">,</span><span class="s">"[""guitar""]"</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="nc">The</span> <span class="nc">Bather</span><span class="o">,</span><span class="s">"[""the"",""bather""]"</span><span class="o">,</span><span class="s">"[""bather""]"</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Mandolin</span><span class="o">,</span><span class="s">"[""woman"",""with"",""mandolin""]"</span><span class="o">,</span><span class="s">"[""woman"",""mandolin""]"</span></code></pre></figure>


<p></p>
Explode word arrays to words:  
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">slpitTitleData</span> <span class="k">=</span> <span class="n">removedStopWordsTitle</span><span class="o">.</span>
   <span class="n">withColumn</span><span class="o">(</span><span class="s">"titleWord"</span><span class="o">,</span><span class="n">explode</span><span class="o">(</span><span class="n">$</span><span class="s">"stopWordFree"</span><span class="o">)).</span>
   <span class="n">drop</span><span class="o">(</span><span class="s">"value"</span><span class="o">,</span><span class="s">"stopWordFree"</span><span class="o">).</span><span class="n">distinct</span>

<span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">).</span><span class="n">orderBy</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">))</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="nc">Agapanthus</span><span class="o">,</span><span class="n">agapanthus</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="s">"On the Cliff at Pourville, Clear Weather"</span><span class="o">,</span><span class="n">weather</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="s">"On the Cliff at Pourville, Clear Weather"</span><span class="o">,</span><span class="n">cliff</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="s">"On the Cliff at Pourville, Clear Weather"</span><span class="o">,</span><span class="n">clear</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="s">"On the Cliff at Pourville, Clear Weather"</span><span class="o">,</span><span class="n">pourville</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="nc">The</span> <span class="nc">Japanese</span> <span class="nc">Footbridge</span><span class="o">,</span><span class="n">footbridge</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="nc">The</span> <span class="nc">Japanese</span> <span class="nc">Footbridge</span><span class="o">,</span><span class="n">japanese</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="nc">Water</span> <span class="nc">Lilies</span><span class="o">,</span><span class="n">lilies</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="nc">Water</span> <span class="nc">Lilies</span><span class="o">,</span><span class="n">water</span></code></pre></figure>


<p><h3>Title Words Analysis</h3>
<p><h4>{Artist, Title Words} distribution</h4>
<p></p>
How many title words artists used in their titles?
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">).</span><span class="n">count</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="ss">'count.</span><span class="n">desc</span><span class="o">))</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">125</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">83</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="mi">60</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">55</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="mi">29</span>
<span class="nc">Jackson</span> <span class="nc">Pollock</span><span class="o">,</span><span class="mi">28</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="mi">27</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">26</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="mi">25</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="mi">20</span>
<span class="nc">Vasily</span> <span class="nc">Kandinsky</span><span class="o">,</span><span class="mi">19</span>
<span class="nc">Oskar</span> <span class="nc">Kokoschka</span><span class="o">,</span><span class="mi">12</span>
<span class="nc">Paul</span> <span class="nc">Gauguin</span><span class="o">,</span><span class="mi">10</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="mi">9</span>
<span class="nc">Max</span> <span class="nc">Beckmann</span><span class="o">,</span><span class="mi">8</span>
<span class="nc">Vincent</span> <span class="n">van</span> <span class="nc">Gogh</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Natalia</span> <span class="nc">Goncharova</span><span class="o">,</span><span class="mi">5</span>
<span class="nc">Marc</span> <span class="nc">Chagall</span><span class="o">,</span><span class="mi">4</span>
<span class="nc">Egon</span> <span class="nc">Schiele</span><span class="o">,</span><span class="mi">3</span>
<span class="nc">Franz</span> <span class="nc">Marc</span><span class="o">,</span><span class="mi">2</span></code></pre></figure>


<p></p>
How many distinct title words artists used?
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">).</span><span class="n">distinct</span><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">).</span><span class="n">count</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="ss">'count.</span><span class="n">desc</span><span class="o">))</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">85</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">74</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">45</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="mi">32</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="mi">28</span>
<span class="nc">Jackson</span> <span class="nc">Pollock</span><span class="o">,</span><span class="mi">25</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">25</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="mi">23</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="mi">22</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="mi">19</span>
<span class="nc">Oskar</span> <span class="nc">Kokoschka</span><span class="o">,</span><span class="mi">12</span>
<span class="nc">Paul</span> <span class="nc">Gauguin</span><span class="o">,</span><span class="mi">10</span>
<span class="nc">Claude</span> <span class="nc">Monet</span><span class="o">,</span><span class="mi">9</span>
<span class="nc">Vasily</span> <span class="nc">Kandinsky</span><span class="o">,</span><span class="mi">9</span>
<span class="nc">Max</span> <span class="nc">Beckmann</span><span class="o">,</span><span class="mi">8</span>
<span class="nc">Vincent</span> <span class="n">van</span> <span class="nc">Gogh</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Natalia</span> <span class="nc">Goncharova</span><span class="o">,</span><span class="mi">5</span>
<span class="nc">Marc</span> <span class="nc">Chagall</span><span class="o">,</span><span class="mi">4</span>
<span class="nc">Egon</span> <span class="nc">Schiele</span><span class="o">,</span><span class="mi">3</span>
<span class="nc">Franz</span> <span class="nc">Marc</span><span class="o">,</span><span class="mi">2</span></code></pre></figure>


<p>Different artists used different words. For example, Paul Signac and Kazimir Malevich had very different styles so they used very different words to describe their paintings:  </p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'Artist=</span><span class="o">==</span><span class="s">"Paul Signac"</span><span class="o">).</span><span class="n">orderBy</span><span class="o">(</span><span class="s">"titleWord"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">))</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">adagio</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">angles</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">background</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">beats</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">boats</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">concarneau</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">enamel</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">fishing</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">lix</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">opus</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">opus</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">portrait</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">rhythmic</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">sardine</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">sea</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">series</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">setting</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">sun</span><span class="o">,</span><span class="s">"Setting Sun. Sardine Fishing. Adagio. Opus 221 from the series The Sea, The Boats, Concarneau"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">tints</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="n">tones</span><span class="o">,</span><span class="s">"Opus 217. Against the Enamel of a Background Rhythmic with Beats and Angles, Tones, and Tints, Portrait of M. Félix Fénéon in 1890"</span></code></pre></figure>


<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'Artist=</span><span class="o">==</span><span class="s">"Kazimir Malevich"</span><span class="o">).</span><span class="n">orderBy</span><span class="o">(</span><span class="s">"titleWord"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">))</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">airplane</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">Airplane</span> <span class="kt">Flying</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">arrangement</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="nc">Pails</span><span class="k">:</span> <span class="kt">Dynamic</span> <span class="kt">Arrangement</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">boy</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">color</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">composition</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">Airplane</span> <span class="kt">Flying</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">composition</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">White</span> <span class="kt">on</span> <span class="kt">White</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">dimension</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">division</span><span class="o">,</span><span class="nc">Reservist</span> <span class="n">of</span> <span class="n">the</span> <span class="nc">First</span> <span class="nc">Division</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">dynamic</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="nc">Pails</span><span class="k">:</span> <span class="kt">Dynamic</span> <span class="kt">Arrangement</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">first</span><span class="o">,</span><span class="nc">Reservist</span> <span class="n">of</span> <span class="n">the</span> <span class="nc">First</span> <span class="nc">Division</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">flying</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">Airplane</span> <span class="kt">Flying</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">fourth</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">knapsack</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">masses</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">pails</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="nc">Pails</span><span class="k">:</span> <span class="kt">Dynamic</span> <span class="kt">Arrangement</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">painterly</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">painting</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Painting</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">realism</span><span class="o">,</span><span class="nc">Painterly</span> <span class="nc">Realism</span> <span class="n">of</span> <span class="n">a</span> <span class="nc">Boy</span> <span class="k">with</span> <span class="n">a</span> <span class="nc">Knapsack</span> <span class="o">-</span> <span class="nc">Color</span> <span class="nc">Masses</span> <span class="n">in</span> <span class="n">the</span> <span class="nc">Fourth</span> <span class="nc">Dimension</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">reservist</span><span class="o">,</span><span class="nc">Reservist</span> <span class="n">of</span> <span class="n">the</span> <span class="nc">First</span> <span class="nc">Division</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">samovar</span><span class="o">,</span><span class="nc">Samovar</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">suprematist</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">Airplane</span> <span class="kt">Flying</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">suprematist</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">White</span> <span class="kt">on</span> <span class="kt">White</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">suprematist</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Painting</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">white</span><span class="o">,</span><span class="nc">Suprematist</span> <span class="nc">Composition</span><span class="k">:</span> <span class="kt">White</span> <span class="kt">on</span> <span class="kt">White</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="n">woman</span><span class="o">,</span><span class="nc">Woman</span> <span class="k">with</span> <span class="nc">Pails</span><span class="k">:</span> <span class="kt">Dynamic</span> <span class="kt">Arrangement</span></code></pre></figure>


<p></p>
<p><h4>{Title Words, Artist} distribution</h4>
<p></p>
What title words used often by artists?
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">groupBy</span><span class="o">(</span><span class="s">"titleWord"</span><span class="o">).</span><span class="n">count</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="ss">'count.</span><span class="n">desc</span><span class="o">,</span><span class="ss">'titleWord)</span><span class="o">)</span>
<span class="n">titleWord</span><span class="o">,</span><span class="n">count</span>
<span class="n">life</span><span class="o">,</span><span class="mi">16</span>
<span class="n">still</span><span class="o">,</span><span class="mi">16</span>
<span class="n">woman</span><span class="o">,</span><span class="mi">15</span>
<span class="n">composition</span><span class="o">,</span><span class="mi">14</span>
<span class="n">portrait</span><span class="o">,</span><span class="mi">12</span>
<span class="n">bather</span><span class="o">,</span><span class="mi">7</span>
<span class="n">blue</span><span class="o">,</span><span class="mi">7</span>
<span class="n">red</span><span class="o">,</span><span class="mi">7</span>
<span class="n">guitar</span><span class="o">,</span><span class="mi">5</span>
<span class="n">landscape</span><span class="o">,</span><span class="mi">5</span>
<span class="n">white</span><span class="o">,</span><span class="mi">5</span></code></pre></figure>


<p></p>What title words are used by at least three artists?
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">).</span><span class="n">distinct</span><span class="o">.</span>
  <span class="n">groupBy</span><span class="o">(</span><span class="s">"titleWord"</span><span class="o">).</span><span class="n">count</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="ss">'count.</span><span class="n">desc</span><span class="o">,</span><span class="ss">'titleWord)</span><span class="o">)</span>
<span class="n">titleWord</span><span class="o">,</span><span class="n">count</span>
<span class="n">portrait</span><span class="o">,</span><span class="mi">9</span>
<span class="n">life</span><span class="o">,</span><span class="mi">6</span>
<span class="n">still</span><span class="o">,</span><span class="mi">6</span>
<span class="n">landscape</span><span class="o">,</span><span class="mi">5</span>
<span class="n">woman</span><span class="o">,</span><span class="mi">5</span>
<span class="n">bather</span><span class="o">,</span><span class="mi">4</span>
<span class="n">self</span><span class="o">,</span><span class="mi">4</span>
<span class="n">white</span><span class="o">,</span><span class="mi">4</span>
<span class="n">bird</span><span class="o">,</span><span class="mi">3</span>
<span class="n">blue</span><span class="o">,</span><span class="mi">3</span>
<span class="n">boy</span><span class="o">,</span><span class="mi">3</span>
<span class="n">composition</span><span class="o">,</span><span class="mi">3</span>
<span class="n">dish</span><span class="o">,</span><span class="mi">3</span>
<span class="n">fruit</span><span class="o">,</span><span class="mi">3</span>
<span class="n">interior</span><span class="o">,</span><span class="mi">3</span>
<span class="n">night</span><span class="o">,</span><span class="mi">3</span>
<span class="n">painting</span><span class="o">,</span><span class="mi">3</span>
<span class="n">red</span><span class="o">,</span><span class="mi">3</span>
<span class="n">studio</span><span class="o">,</span><span class="mi">3</span>
<span class="n">table</span><span class="o">,</span><span class="mi">3</span>
<span class="n">three</span><span class="o">,</span><span class="mi">3</span></code></pre></figure>

<h3>Build a Knowledge Graph</h3>
</p><p>
To show a different look at data we will build a knowledge graph as connections between artists, title words and years when paintings were created:

<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">artistYearWordData</span><span class="k">=</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"lastYear"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">).</span>
  <span class="n">toDF</span><span class="o">(</span><span class="s">"artist"</span><span class="o">,</span><span class="s">"createdYear"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">)</span>
<span class="k">val</span> <span class="n">columnList</span><span class="k">=</span><span class="n">artistYearWordData</span><span class="o">.</span><span class="n">columns</span>

<span class="n">columnList</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="nc">Array</span><span class="o">(</span><span class="n">artist</span><span class="o">,</span> <span class="n">createdYear</span><span class="o">,</span> <span class="n">titleWord</span><span class="o">)</span></code></pre></figure>

<p></p>
We will build a knowledge graph based on all pairs: {artist, title word}, {artist, created year}, {title word, created year}. Also we will add a node type attribute to graph vertices:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">var</span> <span class="n">graphNodes</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="o">=</span><span class="nc">Seq</span><span class="o">((</span><span class="s">""</span><span class="o">,</span><span class="s">""</span><span class="o">)).</span><span class="n">toDF</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span><span class="s">"nodeType"</span><span class="o">)</span>
<span class="k">var</span> <span class="n">graphEdges</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="o">=</span><span class="nc">Seq</span><span class="o">((</span><span class="s">""</span><span class="o">,</span><span class="s">""</span><span class="o">,</span><span class="s">""</span><span class="o">)).</span><span class="n">toDF</span><span class="o">(</span><span class="s">"src"</span><span class="o">,</span><span class="s">"dst"</span><span class="o">,</span><span class="s">"edgeType"</span><span class="o">)</span>
<span class="k">var</span> <span class="n">idx</span><span class="k">=</span><span class="mi">0</span>
<span class="k">for</span> <span class="o">(</span><span class="n">columnx</span> <span class="k">&lt;-</span> <span class="n">columnList</span><span class="o">)</span> <span class="o">{</span>  
  <span class="k">var</span> <span class="n">idy</span><span class="k">=</span><span class="mi">0</span>
  <span class="n">graphNodes</span><span class="k">=</span><span class="n">graphNodes</span><span class="o">.</span><span class="n">union</span><span class="o">(</span><span class="n">artistYearWordData</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">columnx</span><span class="o">).</span>
    <span class="n">withColumn</span><span class="o">(</span><span class="s">"nodeType"</span><span class="o">,</span><span class="n">lit</span><span class="o">(</span><span class="n">columnx</span><span class="o">)))</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">columny</span> <span class="k">&lt;-</span> <span class="n">columnList</span><span class="o">)</span> <span class="o">{</span>
    <span class="n">graphEdges</span><span class="k">=</span><span class="n">graphEdges</span><span class="o">.</span><span class="n">union</span><span class="o">(</span><span class="n">artistYearWordData</span><span class="o">.</span>
      <span class="n">select</span><span class="o">(</span><span class="n">artistYearWordData</span><span class="o">.</span><span class="n">columns</span><span class="o">(</span><span class="n">idx</span><span class="o">),</span><span class="n">columny</span><span class="o">).</span>
    <span class="n">toDF</span><span class="o">(</span><span class="s">"src"</span><span class="o">,</span><span class="s">"dst"</span><span class="o">).</span><span class="n">withColumn</span><span class="o">(</span><span class="s">"edgeType"</span><span class="o">,</span><span class="n">lit</span><span class="o">(</span><span class="n">columny</span><span class="o">))).</span><span class="n">distinct</span>
    <span class="n">idy</span><span class="k">=</span><span class="n">idy</span><span class="o">+</span><span class="mi">1</span>
  <span class="o">}</span>
  <span class="n">idx</span><span class="k">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
 <span class="o">}</span></code></pre></figure>


<p></p>
Build a graph:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">graphNodesArtistYearWord</span><span class="k">=</span><span class="n">graphNodes</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'id=</span><span class="o">!=</span><span class="s">""</span><span class="o">).</span><span class="n">distinct</span>
<span class="k">val</span> <span class="n">graphEdgesArtistYearWord</span><span class="k">=</span><span class="n">graphEdges</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'src=</span><span class="o">!=</span><span class="s">""</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'dst=</span><span class="o">!=</span><span class="s">""</span><span class="o">).</span><span class="n">filter</span><span class="o">(</span><span class="ss">'src=</span><span class="o">!='</span><span class="n">dst</span><span class="o">).</span><span class="n">distinct</span>
<span class="k">val</span> <span class="n">graphArtistYearWord</span> <span class="k">=</span> <span class="nc">GraphFrame</span><span class="o">(</span><span class="n">graphNodesArtistYearWord</span><span class="o">,</span><span class="n">graphEdgesArtistYearWord</span><span class="o">)</span></code></pre></figure>


</p><p>
<h4>Generic Function to Transform Table to Knowledge Graph </h4>
<p></p>
We will combine these steps and create a function that builds a knowledge graph based on all possible column pairs in the table. This function will work for any DataFrame table.
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">table2graph</span><span class="o">(</span><span class="n">table</span><span class="k">:</span> <span class="kt">DataFrame</span><span class="o">)</span><span class="k">:</span> <span class="kt">GraphFrame</span> <span class="o">=</span> <span class="o">{</span>
  <span class="k">var</span> <span class="n">graphNodes</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="o">=</span><span class="nc">Seq</span><span class="o">((</span><span class="s">""</span><span class="o">,</span><span class="s">""</span><span class="o">)).</span><span class="n">toDF</span><span class="o">(</span><span class="s">"id"</span><span class="o">,</span><span class="s">"nodeType"</span><span class="o">)</span>
  <span class="k">var</span> <span class="n">graphEdges</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="o">=</span><span class="nc">Seq</span><span class="o">((</span><span class="s">""</span><span class="o">,</span><span class="s">""</span><span class="o">,</span><span class="s">""</span><span class="o">)).</span><span class="n">toDF</span><span class="o">(</span><span class="s">"src"</span><span class="o">,</span><span class="s">"dst"</span><span class="o">,</span><span class="s">"edgeType"</span><span class="o">)</span>
  <span class="k">var</span> <span class="n">idx</span><span class="k">=</span><span class="mi">0</span>
  <span class="k">val</span> <span class="n">columnList</span><span class="k">=</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span>
  <span class="k">for</span> <span class="o">(</span><span class="n">columnx</span> <span class="k">&lt;-</span> <span class="n">columnList</span><span class="o">)</span> <span class="o">{</span>  
    <span class="k">var</span> <span class="n">idy</span><span class="k">=</span><span class="mi">0</span>
    <span class="n">graphNodes</span><span class="k">=</span><span class="n">graphNodes</span><span class="o">.</span><span class="n">union</span><span class="o">(</span><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">columnx</span><span class="o">).</span><span class="n">withColumn</span><span class="o">(</span><span class="s">"nodeType"</span><span class="o">,</span><span class="n">lit</span><span class="o">(</span><span class="n">columnx</span><span class="o">)))</span>
    <span class="k">for</span> <span class="o">(</span><span class="n">columny</span> <span class="k">&lt;-</span> <span class="n">columnList</span><span class="o">)</span> <span class="o">{</span>
      <span class="n">graphEdges</span><span class="k">=</span><span class="n">graphEdges</span><span class="o">.</span><span class="n">union</span><span class="o">(</span><span class="n">table</span><span class="o">.</span><span class="n">select</span><span class="o">(</span><span class="n">table</span><span class="o">.</span><span class="n">columns</span><span class="o">(</span><span class="n">idx</span><span class="o">),</span><span class="n">columny</span><span class="o">).</span>
      <span class="n">toDF</span><span class="o">(</span><span class="s">"src"</span><span class="o">,</span><span class="s">"dst"</span><span class="o">).</span><span class="n">withColumn</span><span class="o">(</span><span class="s">"edgeType"</span><span class="o">,</span><span class="n">lit</span><span class="o">(</span><span class="n">columny</span><span class="o">))).</span><span class="n">distinct</span>
      <span class="n">idy</span><span class="k">=</span><span class="n">idy</span><span class="o">+</span><span class="mi">1</span>
    <span class="o">}</span>
    <span class="n">idx</span><span class="k">=</span><span class="n">idx</span><span class="o">+</span><span class="mi">1</span>
   <span class="o">}</span>
 <span class="nc">GraphFrame</span><span class="o">(</span><span class="n">graphNodes</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'id=</span><span class="o">!=</span><span class="s">""</span><span class="o">).</span><span class="n">distinct</span><span class="o">,</span><span class="n">graphEdges</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'src=</span><span class="o">!=</span><span class="s">""</span><span class="o">).</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dst=</span><span class="o">!=</span><span class="s">""</span><span class="o">).</span><span class="n">filter</span><span class="o">(</span><span class="ss">'src=</span><span class="o">!='</span><span class="n">dst</span><span class="o">).</span><span class="n">distinct</span><span class="o">)</span>
<span class="o">}</span></code></pre></figure>

<p></p>

<p></p>
Build {Artist, Year, Word} graph :
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">graphArtistYearWord</span><span class="k">=</span><span class="n">table2graph</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span>
  <span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"lastYear"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">).</span>
  <span class="n">toDF</span><span class="o">(</span><span class="s">"artist"</span><span class="o">,</span><span class="s">"createdYear"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">))</span></code></pre></figure>


<a href="#">
    <img src="/img/moma7.jpg" alt="Post Sample Image" width="888" height="600" />
</a>
</p><p>
<h3>Subgraphs around Hubs</h3>
<p></p>

To show subgraph around graph hubs, first we will find high degree nodes, next we will find neighbors of hubs.
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">degrees</span> <span class="k">=</span> <span class="n">graphArtistYearWord</span><span class="o">.</span><span class="n">degrees</span>
<span class="n">display</span><span class="o">(</span><span class="n">degrees</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="n">desc</span><span class="o">(</span><span class="s">"degree"</span><span class="o">)))</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">232</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">188</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">126</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="mi">92</span>
<span class="nc">Jackson</span> <span class="nc">Pollock</span><span class="o">,</span><span class="mi">76</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="mi">76</span>
<span class="mi">1909</span><span class="o">,</span><span class="mi">74</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">64</span>
<span class="mi">1914</span><span class="o">,</span><span class="mi">64</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="mi">62</span>
<span class="mi">1913</span><span class="o">,</span><span class="mi">54</span>
<span class="nc">Kazimir</span> <span class="nc">Malevich</span><span class="o">,</span><span class="mi">54</span>
<span class="mi">1915</span><span class="o">,</span><span class="mi">52</span>
<span class="mi">1906</span><span class="o">,</span><span class="mi">44</span>
<span class="mi">1912</span><span class="o">,</span><span class="mi">44</span>
<span class="mi">1950</span><span class="o">,</span><span class="mi">42</span>
<span class="nc">Paul</span> <span class="nc">Signac</span><span class="o">,</span><span class="mi">42</span>
<span class="n">still</span><span class="o">,</span><span class="mi">42</span>
<span class="n">life</span><span class="o">,</span><span class="mi">42</span>
<span class="mi">1921</span><span class="o">,</span><span class="mi">40</span>
<span class="n">portrait</span><span class="o">,</span><span class="mi">40</span>
<span class="mi">1917</span><span class="o">,</span><span class="mi">40</span></code></pre></figure>


<p></p>
To get dot language for subgraphs around hubs we will transform the whole graph to dot language using graph2dot function and select subsets of dot lines.
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">graph2dot</span><span class="o">(</span><span class="n">graph</span><span class="k">:</span> <span class="kt">GraphFrame</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distinct</span><span class="o">.</span>
    <span class="n">map</span><span class="o">(</span><span class="n">s</span><span class="o">=&gt;(</span><span class="s">"\""</span><span class="o">+</span><span class="n">s</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">toString</span> <span class="o">+</span><span class="s">"\" -&gt; \""</span>
      <span class="o">+</span><span class="n">s</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="n">toString</span> <span class="o">+</span><span class="s">"\""</span><span class="o">+</span><span class="s">" [label=\""</span><span class="o">+(</span><span class="n">s</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">toString</span><span class="o">)+</span><span class="s">"\"];"</span><span class="o">)).</span>
      <span class="n">toDF</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">)</span>  
<span class="o">}</span>
<span class="k">val</span> <span class="n">dotlineArtistYearWord</span><span class="k">=</span><span class="n">graph2dot</span><span class="o">(</span><span class="n">graphArtistYearWord</span><span class="o">)</span></code></pre></figure>


<p></p>
Example 1: nodes around 'Piet Mondrian':
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Piet Mondrian"</span><span class="o">)))</span></code></pre></figure>


<a href="#">
    <img src="/img/moma14.jpg" alt="Post Sample Image" width="333" height="600" />
</a>

<p></p>
Example 2: Neighbor nodes of year 1909:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1909"</span><span class="o">)))</span></code></pre></figure>



<a href="#">
    <img src="/img/moma8.jpg" alt="Post Sample Image" width="333" height="600" />
</a>

<p></p>
Example 3: Neighbors of title word: "portrait"
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"portrait"</span><span class="o">)))</span></code></pre></figure>



<a href="#">
    <img src="/img/moma9.jpg" alt="Post Sample Image" width="333" height="600" />
</a>
<p></p>
Example 4: Title word: "life"
<p></p>
<a href="#">
    <img src="/img/moma10.jpg" alt="Post Sample Image" width="355" height="600" />
</a>
<p></p>
Example 5: Title word: "still"

<a href="#">
    <img src="/img/moma11.jpg" alt="Post Sample Image" width="355" height="600" />
</a>


<h3>Semantic Connections between Title Words</h3>
<p></p>
Graphs around title words 'still' and 'life' look very similar: probably most of these words came from 'still life' related titles. To see how 'still' and 'life' are connected we will combine their dot lines:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"life"</span><span class="o">)</span> <span class="o">||</span> <span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"still"</span><span class="o">)))</span></code></pre></figure>


<a href="#">
    <img src="/img/moma13.jpg" alt="Post Sample Image" width="555" height="600" />
</a>
</p><p>
Artists, 'still life' painting titles and years when paintings were created:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="n">lower</span><span class="o">(</span><span class="ss">'Title)</span><span class="o">.</span><span class="n">contains</span><span class="o">(</span><span class="s">"still life"</span><span class="o">)).</span>
  <span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">,</span><span class="s">"lastYear"</span><span class="o">).</span>
  <span class="n">distinct</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"lastYear"</span><span class="o">,</span><span class="s">"Title"</span><span class="o">))</span>

  <span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">The</span> <span class="nc">Table</span> <span class="o">(</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Fan</span><span class="o">),</span><span class="mi">1910</span>
  <span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span><span class="o">,</span><span class="mi">1899</span>
  <span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Aubergines</span><span class="o">,</span><span class="mi">1911</span>
  <span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="s">"""Still Life after Jan Davidsz. de Heem's """"</span><span class="nc">La</span> <span class="nc">Desserte</span><span class="s">"""""""</span><span class="o">,</span><span class="mi">1915</span>
  <span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="o">--</span> <span class="nc">Glove</span> <span class="n">and</span> <span class="nc">Newspaper</span><span class="o">,</span><span class="mi">1921</span>
  <span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="n">I</span><span class="o">,</span><span class="mi">1923</span>
  <span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="nc">II</span><span class="o">,</span><span class="mi">1923</span>
  <span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Old</span> <span class="nc">Shoe</span><span class="o">,</span><span class="mi">1937</span>
  <span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Fruit</span> <span class="n">and</span> <span class="nc">Glass</span><span class="o">,</span><span class="mi">1908</span>
  <span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Liqueur</span> <span class="nc">Bottle</span><span class="o">,</span><span class="mi">1909</span>
  <span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Green</span> <span class="nc">Still</span> <span class="nc">Life</span><span class="o">,</span><span class="mi">1914</span>
  <span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="s">"""Still Life: """"</span><span class="nc">Job</span><span class="s">"""""""</span><span class="o">,</span><span class="mi">1916</span>
  <span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Fruit</span> <span class="nc">Dish</span><span class="o">,</span><span class="mi">1880</span>
  <span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Apples</span><span class="o">,</span><span class="mi">1898</span>
  <span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="s">"Still Life with Ginger Jar, Sugar Bowl, and Oranges"</span><span class="o">,</span><span class="mi">1906</span>
  <span class="nc">Paul</span> <span class="nc">Gauguin</span><span class="o">,</span><span class="nc">Still</span> <span class="nc">Life</span> <span class="k">with</span> <span class="nc">Three</span> <span class="nc">Puppies</span><span class="o">,</span><span class="mi">1888</span>  </code></pre></figure>


<p></p>
<h3>Connections between Artists</h3>
<p></p>

In 'Painting Titles Words Analysis' section we showed that based on painting titles styles of Paul Signac and Kazimir Malevich are very different. Now we will look at nodes around their names and see that Paul Signac and Kazimir Malevich did not have overlaps in time and in title words:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Paul Signac"</span><span class="o">)</span> <span class="o">||</span> <span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Kazimir Malevich"</span><span class="o">)))</span></code></pre></figure>


<a href="#">
    <img src="/img/moma15.jpg" alt="Post Sample Image" width="500" height="600" />
</a>

<p></p>
From some artist pairs you will expect high relationships. For example, let's look at connections between Pablo Picasso and George Braque both of whom started Cubism movement in 1907. Graph shows that Picasso and Braque have many connections via time and title words:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Georges Braque"</span><span class="o">)</span> <span class="o">||</span> <span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Pablo Picasso"</span><span class="o">)))</span></code></pre></figure>



<a href="#">
    <img src="/img/moma17.jpg" alt="Post Sample Image" width="600" height="800" />
</a>
</p><p>

</p><p>
Using motif 'find' function is an elegant way to calculate weights of artists pair links:
</p><p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">artistPairWeight</span><span class="k">=</span><span class="n">graphArtistYearWord</span><span class="o">.</span>
  <span class="n">find</span><span class="o">(</span><span class="s">"(a) - [ab] -&gt; (b); (b) - [bc] -&gt; (c)"</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="n">$</span><span class="s">"a.id"</span><span class="o">=!=</span><span class="n">$</span><span class="s">"c.id"</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="n">$</span><span class="s">"c.nodeType"</span><span class="o">===</span><span class="s">"artist"</span> <span class="o">&amp;&amp;</span> <span class="n">$</span><span class="s">"a.nodeType"</span><span class="o">===</span><span class="s">"artist"</span><span class="o">).</span>
  <span class="n">map</span><span class="o">(</span><span class="n">s</span><span class="o">=&gt;(</span><span class="n">s</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">toString</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">"\\["</span><span class="o">)(</span><span class="mi">1</span><span class="o">).</span><span class="n">split</span><span class="o">(</span><span class="s">","</span><span class="o">)(</span><span class="mi">0</span><span class="o">),</span>
  <span class="n">s</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">toString</span><span class="o">,</span><span class="n">s</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="n">toString</span><span class="o">.</span><span class="n">split</span><span class="o">(</span><span class="s">"\\["</span><span class="o">)(</span><span class="mi">1</span><span class="o">).</span><span class="n">split</span><span class="o">(</span><span class="s">","</span><span class="o">)(</span><span class="mi">0</span><span class="o">))).</span>
  <span class="n">toDF</span><span class="o">(</span><span class="s">"artist1"</span><span class="o">,</span><span class="s">"link"</span><span class="o">,</span><span class="s">"artist2"</span><span class="o">).</span>
  <span class="n">groupBy</span><span class="o">(</span><span class="s">"artist1"</span><span class="o">,</span><span class="s">"artist2"</span><span class="o">).</span><span class="n">count</span><span class="o">.</span><span class="n">toDF</span><span class="o">(</span><span class="s">"artist1"</span><span class="o">,</span><span class="s">"artist2"</span><span class="o">,</span><span class="s">"linkCount"</span><span class="o">)</span>

<span class="n">display</span><span class="o">(</span><span class="n">artistPairWeight</span><span class="o">.</span><span class="n">orderBy</span><span class="o">(</span><span class="ss">'linkCount.</span><span class="n">desc</span><span class="o">))</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">23</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">23</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">17</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">17</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">15</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">15</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">10</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">10</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">9</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">9</span>
<span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="mi">8</span>
<span class="nc">Piet</span> <span class="nc">Mondrian</span><span class="o">,</span><span class="nc">Henri</span> <span class="nc">Matisse</span><span class="o">,</span><span class="mi">8</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="mi">8</span>
<span class="nc">Georges</span> <span class="nc">Braque</span><span class="o">,</span><span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">8</span>
<span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Paul</span> <span class="nc">Klee</span><span class="o">,</span><span class="nc">Joan</span> <span class="nc">Miró</span><span class="o">,</span><span class="mi">7</span>
<span class="nc">Paul</span> <span class="nc">Cézanne</span><span class="o">,</span><span class="nc">Pablo</span> <span class="nc">Picasso</span><span class="o">,</span><span class="mi">7</span></code></pre></figure>


</p><p>
To show weights of artist links we will slightly change the code of transforming connections to DOT language:
</p><p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">artistPairWeight</span><span class="o">.</span><span class="n">map</span><span class="o">(</span><span class="n">s</span><span class="o">=&gt;(</span><span class="s">"\""</span><span class="o">+</span><span class="n">s</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">toString</span> <span class="o">+</span><span class="s">"\" -&gt; \""</span>
  <span class="o">+</span><span class="n">s</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="n">toString</span> <span class="o">+</span><span class="s">"\""</span><span class="o">+</span><span class="s">"[label=\""</span>
  <span class="o">+(</span><span class="n">s</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">toString</span><span class="o">)</span> <span class="o">+</span><span class="s">"\",weight=\""</span>
  <span class="o">+(</span><span class="n">s</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">toString</span><span class="o">)</span> <span class="o">+</span> <span class="s">"\"];"</span><span class="o">)))</span>

  <span class="s">"Pablo Picasso"</span> <span class="o">-&gt;</span> <span class="s">"Kazimir Malevich"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"6"</span> , <span class="kt">weight=</span><span class="err">"6"</span><span class="o">];</span>
  <span class="s">"Henri Matisse"</span> <span class="o">-&gt;</span> <span class="s">"Georges Braque"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"10"</span> , <span class="kt">weight=</span><span class="err">"10"</span><span class="o">];</span>
  <span class="s">"Jackson Pollock"</span> <span class="o">-&gt;</span> <span class="s">"Pablo Picasso"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"4"</span> , <span class="kt">weight=</span><span class="err">"4"</span><span class="o">];</span>
  <span class="s">"Henri Matisse"</span> <span class="o">-&gt;</span> <span class="s">"Natalia Goncharova"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"4"</span> , <span class="kt">weight=</span><span class="err">"4"</span><span class="o">];</span>
  <span class="s">"Henri Matisse"</span> <span class="o">-&gt;</span> <span class="s">"Pablo Picasso"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"23"</span> , <span class="kt">weight=</span><span class="err">"23"</span><span class="o">];</span>
  <span class="s">"Georges Braque"</span> <span class="o">-&gt;</span> <span class="s">"Paul Cézanne"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"6"</span> , <span class="kt">weight=</span><span class="err">"6"</span><span class="o">];</span>
  <span class="s">"Piet Mondrian"</span> <span class="o">-&gt;</span> <span class="s">"Vasily Kandinsky"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"3"</span> , <span class="kt">weight=</span><span class="err">"3"</span><span class="o">];</span>
  <span class="s">"Pablo Picasso"</span> <span class="o">-&gt;</span> <span class="s">"Georges Braque"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"15"</span> , <span class="kt">weight=</span><span class="err">"15"</span><span class="o">];</span>
  <span class="s">"Kazimir Malevich"</span> <span class="o">-&gt;</span> <span class="s">"Pablo Picasso"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"6"</span> , <span class="kt">weight=</span><span class="err">"6"</span><span class="o">];</span>
  <span class="s">"Pablo Picasso"</span> <span class="o">-&gt;</span> <span class="s">"Henri Matisse"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"23"</span> , <span class="kt">weight=</span><span class="err">"23"</span><span class="o">];</span>
  <span class="s">"Marc Chagall"</span> <span class="o">-&gt;</span> <span class="s">"Pablo Picasso"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"3"</span> , <span class="kt">weight=</span><span class="err">"3"</span><span class="o">];</span>
  <span class="s">"Piet Mondrian"</span> <span class="o">-&gt;</span> <span class="s">"Henri Matisse"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"8"</span> , <span class="kt">weight=</span><span class="err">"8"</span><span class="o">];</span>
  <span class="s">"Henri Matisse"</span> <span class="o">-&gt;</span> <span class="s">"Kazimir Malevich"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"6"</span> , <span class="kt">weight=</span><span class="err">"6"</span><span class="o">];</span>
  <span class="s">"Joan Miró"</span> <span class="o">-&gt;</span> <span class="s">"Oskar Kokoschka"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"3"</span> , <span class="kt">weight=</span><span class="err">"3"</span><span class="o">];</span>
  <span class="s">"Georges Braque"</span> <span class="o">-&gt;</span> <span class="s">"Pablo Picasso"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"15"</span> , <span class="kt">weight=</span><span class="err">"15"</span><span class="o">];</span>
  <span class="s">"Pablo Picasso"</span> <span class="o">-&gt;</span> <span class="s">"Joan Miró"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"17"</span> , <span class="kt">weight=</span><span class="err">"17"</span><span class="o">];</span>
  <span class="s">"Paul Klee"</span> <span class="o">-&gt;</span> <span class="s">"Joan Miró"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"7"</span> , <span class="kt">weight=</span><span class="err">"7"</span><span class="o">];</span>
  <span class="s">"Paul Cézanne"</span> <span class="o">-&gt;</span> <span class="s">"Pablo Picasso"</span> <span class="o">[</span><span class="kt">label=</span><span class="err">"7"</span> , <span class="kt">weight=</span><span class="err">"7"</span><span class="o">];</span></code></pre></figure>


</p><p>

<a href="#">
    <img src="/img/moma16.jpg" alt="Post Sample Image" width="600" height="800" />
</a>

<p><h3>Time when Paintings were Created</h3>
</p><p>
Some pairs of years that are far from each other, represent different periods of art and not connected at all:
</p><p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1890"</span><span class="o">)</span> <span class="o">||</span> <span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1912"</span><span class="o">)))</span></code></pre></figure>


</p><p>

</p><p>

<a href="#">
    <img src="/img/moma18.jpg" alt="Post Sample Image" width="500" height="500" />
</a>

</p><p>
Some years are next to each other and highly connected:  
</p><p>



<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">dotlineArtistYearWord</span><span class="o">.</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1913"</span><span class="o">)</span> <span class="o">||</span> <span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1914"</span><span class="o">)))</span></code></pre></figure>


<a href="#">
    <img src="/img/moma19.jpg" alt="Post Sample Image" width="600" height="800" />
</a>
<p></p>
<p><h3>Graph for Artists and Time</h3>

<p></p>
We will build {Artist, Year} graph with only two types of nodes - Artists and Painting Years:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">graphArtistYear</span><span class="k">=</span><span class="n">table2graph</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span>
  <span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"lastYear"</span><span class="o">).</span>
  <span class="n">toDF</span><span class="o">(</span><span class="s">"artist"</span><span class="o">,</span><span class="s">"createdYear"</span><span class="o">))</span></code></pre></figure>


<p></p>
Picasso's Painting Years:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">graph2dot</span><span class="o">(</span><span class="n">graphArtistYear</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Pablo Picasso"</span><span class="o">)))</span></code></pre></figure>


<a href="#">
    <img src="/img/moma22.jpg" alt="Post Sample Image" width="367" height="367" />
</a>
<p></p>

<p></p>
Artists with paintings of years 1913 or 1914:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">graph2dot</span><span class="o">(</span><span class="n">graphArtistYear</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1913"</span><span class="o">)||</span> <span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"1914"</span><span class="o">)))</span></code></pre></figure>

<p></p>
<a href="#">
    <img src="/img/moma21.jpg" alt="Post Sample Image" width="467" height="467" />
</a>
<p></p>

<p></p>
To simlify dot language filtering queries we will slightly modify graph2dot function:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">edge2dot</span><span class="o">(</span><span class="n">graph</span><span class="k">:</span> <span class="kt">GraphFrame</span><span class="o">)</span><span class="k">:</span> <span class="kt">DataFrame</span> <span class="o">=</span> <span class="o">{</span>
  <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="o">.</span><span class="n">distinct</span><span class="o">.</span>
    <span class="n">map</span><span class="o">(</span><span class="n">s</span><span class="o">=&gt;(</span><span class="s">"\""</span><span class="o">+</span><span class="n">s</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">toString</span> <span class="o">+</span><span class="s">"\" -&gt; \""</span>
      <span class="o">+</span><span class="n">s</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="n">toString</span> <span class="o">+</span><span class="s">"\""</span><span class="o">+</span><span class="s">" [label=\""</span><span class="o">+(</span><span class="n">s</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="n">toString</span><span class="o">)+</span><span class="s">"\"];"</span><span class="o">,</span>
      <span class="n">s</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="n">toString</span> <span class="o">,</span> <span class="n">s</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="n">toString</span><span class="o">)).</span>
      <span class="n">toDF</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">,</span><span class="s">"node1"</span><span class="o">,</span><span class="s">"node2"</span><span class="o">)</span>  
<span class="o">}</span></code></pre></figure>


<p></p>
Painting period [1932, 1938]:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphArtistYear</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">((</span><span class="ss">'node1&gt;</span><span class="o">=</span><span class="s">"1932"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node1 </span><span class="o">&lt;=</span><span class="s">"1938"</span><span class="o">)||</span>
  <span class="o">(</span><span class="ss">'node2&gt;</span><span class="o">=</span><span class="s">"1932"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node2 </span><span class="o">&lt;=</span><span class="s">"1938"</span><span class="o">)).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>


<p></p>
<a href="#">
    <img src="/img/moma25.jpg" alt="Post Sample Image" width="400" height="400" />
</a>
<p></p>


<p></p>
Painting period [1912, 1917]:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphArtistYear</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">((</span><span class="ss">'node1&gt;</span><span class="o">=</span><span class="s">"1912"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node1 </span><span class="o">&lt;=</span><span class="s">"1917"</span><span class="o">)||</span>
  <span class="o">(</span><span class="ss">'node2&gt;</span><span class="o">=</span><span class="s">"1912"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node2 </span><span class="o">&lt;=</span><span class="s">"1917"</span><span class="o">)).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>


<p></p>
<a href="#">
    <img src="/img/moma23.jpg" alt="Post Sample Image" width="500" height="500" />
</a>
<p></p>

<p></p>
Two painting periods [1903, 1908] and [1933, 1938]:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphArtistYear</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(((</span><span class="ss">'node1&gt;</span><span class="o">=</span><span class="s">"1933"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node1 </span><span class="o">&lt;=</span><span class="s">"1938"</span><span class="o">)||(</span> <span class="ss">'node2&gt;</span><span class="o">=</span><span class="s">"1933"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node2 </span><span class="o">&lt;=</span><span class="s">"1938"</span><span class="o">))||</span>
  <span class="o">((</span><span class="ss">'node1&gt;</span><span class="o">=</span><span class="s">"1903"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node1 </span><span class="o">&lt;=</span><span class="s">"1908"</span><span class="o">)||(</span> <span class="ss">'node2&gt;</span><span class="o">=</span><span class="s">"1903"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node2 </span><span class="o">&lt;=</span><span class="s">"1908"</span><span class="o">))).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>


<p></p>
<a href="#">
    <img src="/img/moma24.jpg" alt="Post Sample Image" width="600" height="700" />
</a>
<p></p>

<p></p>
<p><h3>Graph for Artists and Title Words</h3>

<p></p>
We will build {Artist, Title Word} graph with two types of nodes - Artist and Title Words:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">graphArtistWord</span><span class="k">=</span><span class="n">table2graph</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span>
  <span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">).</span><span class="n">toDF</span><span class="o">(</span><span class="s">"artist"</span><span class="o">,</span><span class="s">"titleWord"</span><span class="o">))</span></code></pre></figure>


<p></p>
Title words of Piet Mondrian:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">graph2dot</span><span class="o">(</span><span class="n">graphArtistWord</span><span class="o">).</span><span class="n">filter</span><span class="o">(</span><span class="ss">'dotLine.</span><span class="n">rlike</span><span class="o">(</span><span class="s">"Piet Mondrian"</span><span class="o">)))</span></code></pre></figure>

<p></p>
<a href="#">
    <img src="/img/moma30.jpg" alt="Post Sample Image" width="422" height="422" />
</a>
<p></p>
<p></p>
Piet Mondrian had a lot of color title words. Who else mentioned colors in their painting titles?
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphArtistWord</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'node1.</span><span class="n">isin</span><span class="o">(</span><span class="s">"blue"</span><span class="o">,</span><span class="s">"red"</span><span class="o">,</span><span class="s">"white"</span><span class="o">,</span><span class="s">"black"</span><span class="o">,</span><span class="s">"yellow"</span><span class="o">,</span><span class="s">"green"</span><span class="o">,</span><span class="s">"brown"</span><span class="o">,</span><span class="s">"gray"</span>  <span class="o">)||</span>
          <span class="o">(</span> <span class="ss">'node2.</span><span class="n">isin</span><span class="o">(</span><span class="s">"blue"</span> <span class="o">,</span><span class="s">"red"</span><span class="o">,</span><span class="s">"white"</span><span class="o">,</span><span class="s">"black"</span><span class="o">,</span><span class="s">"yellow"</span><span class="o">,</span><span class="s">"green"</span><span class="o">,</span><span class="s">"brown"</span><span class="o">,</span><span class="s">"gray"</span>  <span class="o">))).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>

<p></p>
<a href="#">
    <img src="/img/moma28.jpg" alt="Post Sample Image" width="655" height="655" />
</a>
<p></p>


<p></p>
It's a lot of overlaps between title words of Paul Cézanne and Georges Braque. Was it because Paul Cézanne influenced Cubism movement?
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphArtistWord</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'node1.</span><span class="n">isin</span><span class="o">(</span><span class="s">"Paul Cézanne"</span><span class="o">,</span><span class="s">"Georges Braque"</span> <span class="o">)||</span>
          <span class="o">(</span> <span class="ss">'node2.</span><span class="n">isin</span><span class="o">(</span><span class="s">"Paul Cézanne"</span><span class="o">,</span><span class="s">"Georges Braque"</span> <span class="o">))).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>

<p></p>
<a href="#">
    <img src="/img/moma31.jpg" alt="Post Sample Image" width="711" height="711" />
</a>
<p></p>



<p></p>
<p><h3>Graph for Title Words and Time</h3>

<p></p>
{Title Word, Year} graph with two types of nodes - Title Words and Painting Years:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">val</span> <span class="n">graphArtistYear</span><span class="k">=</span><span class="n">table2graph</span><span class="o">(</span><span class="n">slpitTitleData</span><span class="o">.</span>
  <span class="n">select</span><span class="o">(</span><span class="s">"Artist"</span><span class="o">,</span><span class="s">"lastYear"</span><span class="o">).</span>
  <span class="n">toDF</span><span class="o">(</span><span class="s">"artist"</span><span class="o">,</span><span class="s">"createdYear"</span><span class="o">))</span></code></pre></figure>


<p></p>
Color title words by painting years:
<p></p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphYearWord</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(</span><span class="ss">'node1.</span><span class="n">isin</span><span class="o">(</span><span class="s">"blue"</span><span class="o">,</span><span class="s">"red"</span><span class="o">,</span><span class="s">"white"</span><span class="o">,</span><span class="s">"black"</span><span class="o">,</span><span class="s">"yellow"</span><span class="o">,</span><span class="s">"green"</span><span class="o">,</span><span class="s">"brown"</span><span class="o">,</span><span class="s">"gray"</span>  <span class="o">)||</span>
          <span class="o">(</span> <span class="ss">'node2.</span><span class="n">isin</span><span class="o">(</span><span class="s">"blue"</span> <span class="o">,</span><span class="s">"red"</span><span class="o">,</span><span class="s">"white"</span><span class="o">,</span><span class="s">"black"</span><span class="o">,</span><span class="s">"yellow"</span><span class="o">,</span><span class="s">"green"</span><span class="o">,</span><span class="s">"brown"</span><span class="o">,</span><span class="s">"gray"</span>  <span class="o">))).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>


<p></p>
<a href="#">
    <img src="/img/moma32.jpg" alt="Post Sample Image" width="444" height="444" />
</a>
<p></p>          
<p></p>
Title words in painting years period [1929, 1932]:
<p></p>


<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">display</span><span class="o">(</span><span class="n">edge2dot</span><span class="o">(</span><span class="n">graphYearWord</span><span class="o">).</span>
  <span class="n">filter</span><span class="o">(((</span><span class="ss">'node1&gt;</span><span class="o">=</span><span class="s">"1929"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node1 </span><span class="o">&lt;=</span><span class="s">"1932"</span><span class="o">)||(</span> <span class="ss">'node2&gt;</span><span class="o">=</span><span class="s">"1929"</span> <span class="o">&amp;&amp;</span> <span class="ss">'node2 </span><span class="o">&lt;=</span><span class="s">"1932"</span><span class="o">))).</span><span class="n">select</span><span class="o">(</span><span class="s">"dotLine"</span><span class="o">))</span></code></pre></figure>

<p></p>
<a href="#">
    <img src="/img/moma27.jpg" alt="Post Sample Image" width="655" height="655" />
</a>
<p></p>

<p></p>

<p><h3>Next Post - Paintings</h3>
In the next several posts we will look at Knowledge Graphs as more natural way to represent data.</p>
</p></p></p></p></p></p></p></p></p></p></p>


                <hr>

                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2019/09/24/knowledgeGraphDataAnalysis/" data-toggle="tooltip" data-placement="top" title="Knowledge Graph for Data Mining">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2020/02/02/knowledgeGraphIntegration/" data-toggle="tooltip" data-placement="top" title="Knowledge Graph for Data Integration">Next Post &rarr;</a>
                    </li>
                    
                </ul>

            </div>
        </div>
    </div>
</article>

<hr>


    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    <li>
                        <a href="/feed.xml">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-rss fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                    
                    
                    
                    <li>
                        <a href="mailto:sparkling.dataocean@gmail.com">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-envelope fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">Copyright &copy; Melenar 2021</p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/clean-blog.min.js "></script>


    
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-114694347-1', 'auto');
  ga('send', 'pageview');

</script>



</body>

</html>
